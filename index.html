<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <script >
    const box = {
        locked: true,
        unlock() { this.locked = false; },
        lock() { this.locked = true;  },
        _content: [1,2,3],
        get content() {
            if (this.locked) throw new Error("Locked!");
            return this._content;
        }
    };
 
    //withBoxUnlocked toma como argumento una funcion, quita el candado, ejecuta la funcion y candadea de nuevo
    function withBoxUnlocked(body) {
        let wasLocked = box.locked;
        box.unlock();
        try { 
            body();
        } finally {
            if (wasLocked) {
            box.lock();
            }
        }
    }

    withBoxUnlocked(function() {
        box.content.push("gold piece");
        });

        try {
        withBoxUnlocked(function() {
            throw new Error("Pirates on the horizon! Abort!");
        });
        } catch (e) {
        console.log("Error raised:", e);
    }

    
    </script>

</body>
</html>